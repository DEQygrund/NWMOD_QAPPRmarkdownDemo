```{r, echo=FALSE}

lookup.huc <- readxl::read_xlsx("C:/Users/ygrund/ygrund_C_Users/PROJECTS/20210504_NWMOD/Demo/data/Lookup_QAPPProjectArea.xlsx", sheet = "Lookup_QAPPProjectArea")

cat.45.rivers <- sf::st_read(dsn = "C:/Users/ygrund/ygrund_C_Users/PROJECTS/20210504_NWMOD/Demo/data/2018_2020_IR_Cat4_5_Temp_Rivers_FINAL.shp",
                             layer = "2018_2020_IR_Cat4_5_Temp_Rivers_FINAL") %>% 
  sf::st_zm() %>% 
  dplyr::left_join(lookup.huc, by = "HUC12")

cat.45.tbl <- sf::st_drop_geometry(cat.45.rivers)

pro.cat.45.tbl <- cat.45.tbl %>% 
  dplyr::filter(QAPP_Project_Area %in% qapp_project_area)

tcat5 <- pro.cat.45.tbl %>% 
  dplyr::filter(IR_categor == "Category 5") %>% 
  dplyr::group_by(AU_Name,AU_ID,Year_liste) %>% 
  dplyr::summarize(Period = toString(unique(sort(Period)))) %>% 
  dplyr::ungroup() %>% 
  dplyr::rename(`Assessment Unit Name` = AU_Name,
                `Assessment Unit ID` = AU_ID,
                `Year Listed` = Year_liste,
                `Use Period` = Period) %>% 
  dplyr::select(`Assessment Unit Name`,`Assessment Unit ID`,`Year Listed`,`Use Period`) %>% 
  dplyr::arrange(`Assessment Unit Name`,`Year Listed`)

if(NROW(tcat5)>0){
  
  knitr::kable(tcat5, format = "pandoc", padding = 2,
               caption = tbls(name = "tcat5",
                              caption = paste0("Assessment units listed for temperature impairment based on Section 303(d) Category 5 in the 2018/20 Integrated Report.")))
  
}

```

